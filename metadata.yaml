name: aws-revoke-session
description: Revoke AWS sessions by applying a deny policy for tokens issued before a specific time

# Input parameters for web form generation
inputs:
  roleName:
    type: text
    description: The name of the IAM role to apply the session revocation policy to
    required: true
    validation:
      min: 1
      max: 64

  region:
    type: text
    description: AWS region (e.g., us-east-1)
    required: true
    validation:
      min: 1
      max: 30

  conditions:
    type: json
    description: Optional additional conditions to append to the revocation policy (JSON format)
    required: false

  tokenIssueTime:
    type: datetime
    description: Optional token issue time to revoke sessions before (defaults to current time)
    required: false

# Expected output structure
outputs:
  roleName:
    type: text
    description: The role name that was updated

  policyName:
    type: text
    description: The name of the policy that was applied

  tokenIssueTime:
    type: datetime
    description: The token issue time used for revocation

  applied:
    type: boolean
    description: Whether the policy was successfully applied

  appliedAt:
    type: datetime
    description: When the policy was applied (ISO 8601)

# Required secrets (configured at deployment time)
secrets:
  - AWS_ACCESS_KEY_ID
  - AWS_SECRET_ACCESS_KEY

# Runtime configuration
runtime:
  type: nodejs-22
  timeout: 30s
  memory: 128Mi